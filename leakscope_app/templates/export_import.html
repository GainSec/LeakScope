<!doctype html>
<html class="no-js" lang="">
{% load static %}
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>LeakScope | Export / Import</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/normalize.css' %}">
    <link rel="stylesheet" href="{% static 'css/animate.css' %}">
    <link rel="stylesheet" href="{% static 'css/notika-custom-icon.css' %}">
    <link rel="stylesheet" href="{% static 'css/meanmenu/meanmenu.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/scrollbar/jquery.mCustomScrollbar.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'style.css' %}">
</head>
<body>
    <div class="header-top-area">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                    <div class="logo-area">
                        <a href="{% url 'home' %}"><img src="{% static 'img/leakscope.png' %}" /></a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="main-menu-area mg-tb-40">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <ul class="nav nav-tabs notika-menu-wrap menu-it-icon-pro">
                        <li><a href="{% url 'home' %}"><i class="notika-icon notika-house"></i> Home</a></li>
                        <li><a href="{% url 'keyword' %}"><i class="notika-icon notika-search"></i> Discover</a></li>
                        <li><a href="{% url 'database' %}"><i class="notika-icon notika-edit"></i> Database</a></li>
                        
                        <li><a href="{% url 'custom_queries' %}"><i class="notika-icon notika-star"></i> Custom Query</a></li>
                        <li><a href="{% url 'preview_page' %}"><i class="notika-icon notika-down-arrow"></i> Preview</a></li>
                        <li><a href="{% url 'explore_page' %}"><i class="notika-icon notika-eye"></i> Explore</a></li>
                        <li class="active"><a href="{% url 'export_import' %}"><i class="notika-icon notika-support"></i> Export/Import</a></li>
                    </ul>
                    <div class="tab-content custom-menu-content">
                        <div id="Home" class="tab-pane in active notika-tab-menu-bg animated flipInX"></div>
                        <div id="search" class="tab-pane notika-tab-menu-bg animated flipInX">
                            <ul class="notika-main-menu-dropdown">
                                <li><a href="{% url 'keyword' %}">Keyword</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<div class="container" style="margin-top:10px;">
    <h2>Export / Import</h2>
    <form method="get" class="form-inline" style="margin-bottom:15px;">
        <label for="type" class="mr-2">Type</label>
        <select name="type" id="type" class="form-control mr-2">
            {% for t in types %}
                <option value="{{ t }}" {% if t == selected_type %}selected{% endif %}>{{ t }}</option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-primary">Apply</button>
        {% if selected_type %}
            <a class="btn btn-success ml-2" href="/export?type={{ selected_type }}&format=csv">Export CSV</a>
            <a class="btn btn-info ml-2" href="/export?type={{ selected_type }}&format=json">Export JSON</a>
        {% endif %}
    </form>

    {% if table_rows %}
    <div class="table-responsive">
        <table class="table table-striped table-sm">
            <thead>
            <tr>
                {% for f in display_fields %}<th>{{ f }}</th>{% endfor %}
            </tr>
            </thead>
            <tbody>
            {% for row in table_rows %}
                <tr>
                    {% for cell in row %}<td>{{ cell }}</td>{% endfor %}
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
        <p>No records found for this type.</p>
    {% endif %}

    <hr>
    <h4>Import Blacklist Entries</h4>
    {% if import_status %}<div class="alert alert-info">{{ import_status }}</div>{% endif %}
    <form method="post">
        {% csrf_token %}
        <div class="form-group">
            <label for="import_blacklist">One IP/host per line</label>
            <textarea class="form-control" id="import_blacklist" name="import_blacklist" rows="5" placeholder="1.2.3.4"></textarea>
        </div>
        <button type="submit" class="btn btn-warning">Import to Blacklist</button>
    </form>
</div>
    <footer style="padding: 20px 0; text-align: center; color: #777; font-size: 14px;">
        By <a href="https://gainsec.com/" target="_blank" rel="noopener noreferrer">GainSec</a>
    </footer>
</body>
</html>
